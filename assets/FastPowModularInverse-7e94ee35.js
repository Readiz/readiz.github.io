import{p as t}from"./FastPowModularInverse_-4f770b38.js";import{u as i,j as e,a as n,F as c}from"./ssg-client-7a654c7b.js";import{C as h}from"./Comment-2d449b8a.js";import{H as r}from"./Header-31f4d24d.js";import{T as d}from"./TagList-87a27fe9.js";import"./katex.min-4ed993c7.js";import"./index.module-caf545e8.js";function l(s){const a=Object.assign({h2:"h2",p:"p",span:"span",math:"math",semantics:"semantics",mrow:"mrow",mi:"mi",annotation:"annotation",mo:"mo",code:"code",mn:"mn",msub:"msub",ul:"ul",li:"li",msup:"msup",pre:"pre",a:"a"},i(),s.components);return n(c,{children:[e(r,{}),`
`,e(a.h2,{id:"빠른-거듭제곱과-modular-inverse",children:"빠른 거듭제곱과 Modular Inverse"}),`
`,n(a.p,{children:["일반적으로 특정 수를 ",e(a.span,{className:"math math-inline",children:n(a.span,{className:"katex",children:[e(a.span,{className:"katex-mathml",children:e(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:n(a.semantics,{children:[e(a.mrow,{children:e(a.mi,{children:"N"})}),e(a.annotation,{encoding:"application/x-tex",children:"N"})]})})}),e(a.span,{className:"katex-html","aria-hidden":"true",children:n(a.span,{className:"base",children:[e(a.span,{className:"strut",style:{height:"0.6833em"}}),e(a.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"N"})]})})]})})," 제곱하는데 걸리는 시간은 ",e(a.span,{className:"math math-inline",children:n(a.span,{className:"katex",children:[e(a.span,{className:"katex-mathml",children:e(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:n(a.semantics,{children:[n(a.mrow,{children:[e(a.mi,{children:"O"}),e(a.mo,{stretchy:"false",children:"("}),e(a.mi,{children:"N"}),e(a.mo,{stretchy:"false",children:")"})]}),e(a.annotation,{encoding:"application/x-tex",children:"O(N)"})]})})}),e(a.span,{className:"katex-html","aria-hidden":"true",children:n(a.span,{className:"base",children:[e(a.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),e(a.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"O"}),e(a.span,{className:"mopen",children:"("}),e(a.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"N"}),e(a.span,{className:"mclose",children:")"})]})})]})})," 이지만, 간단한 수학으로 이를 ",e(a.span,{className:"math math-inline",children:n(a.span,{className:"katex",children:[e(a.span,{className:"katex-mathml",children:e(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:n(a.semantics,{children:[n(a.mrow,{children:[e(a.mi,{children:"O"}),e(a.mo,{stretchy:"false",children:"("}),e(a.mi,{children:"log"}),e(a.mo,{children:"⁡"}),e(a.mi,{children:"N"}),e(a.mo,{stretchy:"false",children:")"})]}),e(a.annotation,{encoding:"application/x-tex",children:"O(\\log N)"})]})})}),e(a.span,{className:"katex-html","aria-hidden":"true",children:n(a.span,{className:"base",children:[e(a.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),e(a.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"O"}),e(a.span,{className:"mopen",children:"("}),n(a.span,{className:"mop",children:["lo",e(a.span,{style:{marginRight:"0.01389em"},children:"g"})]}),e(a.span,{className:"mspace",style:{marginRight:"0.1667em"}}),e(a.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"N"}),e(a.span,{className:"mclose",children:")"})]})})]})}),"에 마칠 수 있다. 이는 거듭제곱 하고자 하는 수를 이진수로 보고, ",e(a.code,{children:"binary lifting"})," 하는 것이라고 보면 된다."]}),`
`,n(a.p,{children:["예를 들어, ",e(a.span,{className:"math math-inline",children:n(a.span,{className:"katex",children:[e(a.span,{className:"katex-mathml",children:e(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:n(a.semantics,{children:[e(a.mrow,{children:e(a.mi,{children:"a"})}),e(a.annotation,{encoding:"application/x-tex",children:"a"})]})})}),e(a.span,{className:"katex-html","aria-hidden":"true",children:n(a.span,{className:"base",children:[e(a.span,{className:"strut",style:{height:"0.4306em"}}),e(a.span,{className:"mord mathnormal",children:"a"})]})})]})}),"의 ",e(a.span,{className:"math math-inline",children:n(a.span,{className:"katex",children:[e(a.span,{className:"katex-mathml",children:e(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:n(a.semantics,{children:[e(a.mrow,{children:e(a.mn,{children:"13"})}),e(a.annotation,{encoding:"application/x-tex",children:"13"})]})})}),e(a.span,{className:"katex-html","aria-hidden":"true",children:n(a.span,{className:"base",children:[e(a.span,{className:"strut",style:{height:"0.6444em"}}),e(a.span,{className:"mord",children:"13"})]})})]})})," 제곱을 하고자 한다면, 이는 이진수로 ",e(a.span,{className:"math math-inline",children:n(a.span,{className:"katex",children:[e(a.span,{className:"katex-mathml",children:e(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:n(a.semantics,{children:[n(a.mrow,{children:[e(a.mn,{children:"110"}),n(a.msub,{children:[e(a.mn,{children:"1"}),n(a.mrow,{children:[e(a.mo,{stretchy:"false",children:"("}),e(a.mn,{children:"2"}),e(a.mo,{stretchy:"false",children:")"})]})]})]}),e(a.annotation,{encoding:"application/x-tex",children:"1101_{(2)}"})]})})}),e(a.span,{className:"katex-html","aria-hidden":"true",children:n(a.span,{className:"base",children:[e(a.span,{className:"strut",style:{height:"0.9996em",verticalAlign:"-0.3552em"}}),e(a.span,{className:"mord",children:"110"}),n(a.span,{className:"mord",children:[e(a.span,{className:"mord",children:"1"}),e(a.span,{className:"msupsub",children:n(a.span,{className:"vlist-t vlist-t2",children:[n(a.span,{className:"vlist-r",children:[e(a.span,{className:"vlist",style:{height:"0.3448em"},children:n(a.span,{style:{top:"-2.5198em",marginLeft:"0em",marginRight:"0.05em"},children:[e(a.span,{className:"pstrut",style:{height:"2.7em"}}),e(a.span,{className:"sizing reset-size6 size3 mtight",children:n(a.span,{className:"mord mtight",children:[e(a.span,{className:"mopen mtight",children:"("}),e(a.span,{className:"mord mtight",children:"2"}),e(a.span,{className:"mclose mtight",children:")"})]})})]})}),e(a.span,{className:"vlist-s",children:"​"})]}),e(a.span,{className:"vlist-r",children:e(a.span,{className:"vlist",style:{height:"0.3552em"},children:e(a.span,{})})})]})})]})]})})]})}),"이므로,"]}),`
`,n(a.ul,{children:[`
`,n(a.li,{children:[e(a.span,{className:"math math-inline",children:n(a.span,{className:"katex",children:[e(a.span,{className:"katex-mathml",children:e(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:n(a.semantics,{children:[e(a.mrow,{children:e(a.mn,{children:"1"})}),e(a.annotation,{encoding:"application/x-tex",children:"1"})]})})}),e(a.span,{className:"katex-html","aria-hidden":"true",children:n(a.span,{className:"base",children:[e(a.span,{className:"strut",style:{height:"0.6444em"}}),e(a.span,{className:"mord",children:"1"})]})})]})})," 제곱 한 수"]}),`
`,n(a.li,{children:[e(a.span,{className:"math math-inline",children:n(a.span,{className:"katex",children:[e(a.span,{className:"katex-mathml",children:e(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:n(a.semantics,{children:[e(a.mrow,{children:e(a.mn,{children:"4"})}),e(a.annotation,{encoding:"application/x-tex",children:"4"})]})})}),e(a.span,{className:"katex-html","aria-hidden":"true",children:n(a.span,{className:"base",children:[e(a.span,{className:"strut",style:{height:"0.6444em"}}),e(a.span,{className:"mord",children:"4"})]})})]})})," 제곱 한 수"]}),`
`,n(a.li,{children:[e(a.span,{className:"math math-inline",children:n(a.span,{className:"katex",children:[e(a.span,{className:"katex-mathml",children:e(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:n(a.semantics,{children:[e(a.mrow,{children:e(a.mn,{children:"8"})}),e(a.annotation,{encoding:"application/x-tex",children:"8"})]})})}),e(a.span,{className:"katex-html","aria-hidden":"true",children:n(a.span,{className:"base",children:[e(a.span,{className:"strut",style:{height:"0.6444em"}}),e(a.span,{className:"mord",children:"8"})]})})]})})," 제곱 한 수"]}),`
`]}),`
`,n(a.p,{children:["를 모두 곱하면 된다. ",e(a.span,{className:"math math-inline",children:n(a.span,{className:"katex",children:[e(a.span,{className:"katex-mathml",children:e(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:n(a.semantics,{children:[e(a.mrow,{children:n(a.msup,{children:[e(a.mn,{children:"2"}),e(a.mi,{children:"n"})]})}),e(a.annotation,{encoding:"application/x-tex",children:"2^n"})]})})}),e(a.span,{className:"katex-html","aria-hidden":"true",children:n(a.span,{className:"base",children:[e(a.span,{className:"strut",style:{height:"0.6644em"}}),n(a.span,{className:"mord",children:[e(a.span,{className:"mord",children:"2"}),e(a.span,{className:"msupsub",children:e(a.span,{className:"vlist-t",children:e(a.span,{className:"vlist-r",children:e(a.span,{className:"vlist",style:{height:"0.6644em"},children:n(a.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[e(a.span,{className:"pstrut",style:{height:"2.7em"}}),e(a.span,{className:"sizing reset-size6 size3 mtight",children:e(a.span,{className:"mord mathnormal mtight",children:"n"})})]})})})})})]})]})})]})})," 제곱 한 수는 같은 수를 두번 곱함으로써 빠르게 구해진다. (",e(a.span,{className:"math math-inline",children:n(a.span,{className:"katex",children:[e(a.span,{className:"katex-mathml",children:e(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:n(a.semantics,{children:[e(a.mrow,{children:e(a.mn,{children:"8"})}),e(a.annotation,{encoding:"application/x-tex",children:"8"})]})})}),e(a.span,{className:"katex-html","aria-hidden":"true",children:n(a.span,{className:"base",children:[e(a.span,{className:"strut",style:{height:"0.6444em"}}),e(a.span,{className:"mord",children:"8"})]})})]})}),"제곱한 수는 ",e(a.span,{className:"math math-inline",children:n(a.span,{className:"katex",children:[e(a.span,{className:"katex-mathml",children:e(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:n(a.semantics,{children:[e(a.mrow,{children:e(a.mn,{children:"4"})}),e(a.annotation,{encoding:"application/x-tex",children:"4"})]})})}),e(a.span,{className:"katex-html","aria-hidden":"true",children:n(a.span,{className:"base",children:[e(a.span,{className:"strut",style:{height:"0.6444em"}}),e(a.span,{className:"mord",children:"4"})]})})]})}),"제곱한 수를 두번 곱하면 된다)"]}),`
`,n(a.p,{children:["따라서 아래와 같은 알고리즘 작성이 가능하다. ",e(a.span,{className:"math math-inline",children:n(a.span,{className:"katex",children:[e(a.span,{className:"katex-mathml",children:e(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:n(a.semantics,{children:[e(a.mrow,{children:n(a.msup,{children:[e(a.mi,{children:"a"}),e(a.mi,{children:"p"})]})}),e(a.annotation,{encoding:"application/x-tex",children:"a^p"})]})})}),e(a.span,{className:"katex-html","aria-hidden":"true",children:n(a.span,{className:"base",children:[e(a.span,{className:"strut",style:{height:"0.6644em"}}),n(a.span,{className:"mord",children:[e(a.span,{className:"mord mathnormal",children:"a"}),e(a.span,{className:"msupsub",children:e(a.span,{className:"vlist-t",children:e(a.span,{className:"vlist-r",children:e(a.span,{className:"vlist",style:{height:"0.6644em"},children:n(a.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[e(a.span,{className:"pstrut",style:{height:"2.7em"}}),e(a.span,{className:"sizing reset-size6 size3 mtight",children:e(a.span,{className:"mord mathnormal mtight",children:"p"})})]})})})})})]})]})})]})}),"를 구하는 알고리즘이다. 기하급수적으로 커지므로, ",e(a.code,{children:"MOD"}),"로 나머지만 들고다니도록 많이 구현하는 편."]}),`
`,e(a.pre,{children:e(a.code,{className:"language-cpp",children:`ll fpow(ll a, ll p) {
    ll res = 1LL;
    while (p) {
        if (p & 1LL) res = res * a % MOD;
        a = a * a % MOD;
        p >>= 1LL;
    }
    return res;
}
`})}),`
`,e(a.h2,{id:"modular-inverse",children:"Modular Inverse"}),`
`,n(a.p,{children:["오일러 공식을 사용하면, ",e(a.span,{className:"math math-inline",children:n(a.span,{className:"katex",children:[e(a.span,{className:"katex-mathml",children:e(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:n(a.semantics,{children:[e(a.mrow,{children:e(a.mi,{children:"p"})}),e(a.annotation,{encoding:"application/x-tex",children:"p"})]})})}),e(a.span,{className:"katex-html","aria-hidden":"true",children:n(a.span,{className:"base",children:[e(a.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),e(a.span,{className:"mord mathnormal",children:"p"})]})})]})}),"가 소수일 때, ",e(a.span,{className:"math math-inline",children:n(a.span,{className:"katex",children:[e(a.span,{className:"katex-mathml",children:e(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:n(a.semantics,{children:[n(a.mrow,{children:[n(a.msup,{children:[e(a.mi,{children:"n"}),n(a.mrow,{children:[e(a.mo,{children:"−"}),e(a.mn,{children:"1"})]})]}),e(a.mo,{children:"="}),n(a.msup,{children:[e(a.mi,{children:"n"}),n(a.mrow,{children:[e(a.mi,{children:"p"}),e(a.mo,{children:"−"}),e(a.mn,{children:"2"})]})]})]}),e(a.annotation,{encoding:"application/x-tex",children:"n^{-1} = n^{p-2}"})]})})}),n(a.span,{className:"katex-html","aria-hidden":"true",children:[n(a.span,{className:"base",children:[e(a.span,{className:"strut",style:{height:"0.8141em"}}),n(a.span,{className:"mord",children:[e(a.span,{className:"mord mathnormal",children:"n"}),e(a.span,{className:"msupsub",children:e(a.span,{className:"vlist-t",children:e(a.span,{className:"vlist-r",children:e(a.span,{className:"vlist",style:{height:"0.8141em"},children:n(a.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[e(a.span,{className:"pstrut",style:{height:"2.7em"}}),e(a.span,{className:"sizing reset-size6 size3 mtight",children:n(a.span,{className:"mord mtight",children:[e(a.span,{className:"mord mtight",children:"−"}),e(a.span,{className:"mord mtight",children:"1"})]})})]})})})})})]}),e(a.span,{className:"mspace",style:{marginRight:"0.2778em"}}),e(a.span,{className:"mrel",children:"="}),e(a.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),n(a.span,{className:"base",children:[e(a.span,{className:"strut",style:{height:"0.8141em"}}),n(a.span,{className:"mord",children:[e(a.span,{className:"mord mathnormal",children:"n"}),e(a.span,{className:"msupsub",children:e(a.span,{className:"vlist-t",children:e(a.span,{className:"vlist-r",children:e(a.span,{className:"vlist",style:{height:"0.8141em"},children:n(a.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[e(a.span,{className:"pstrut",style:{height:"2.7em"}}),e(a.span,{className:"sizing reset-size6 size3 mtight",children:n(a.span,{className:"mord mtight",children:[e(a.span,{className:"mord mathnormal mtight",children:"p"}),e(a.span,{className:"mbin mtight",children:"−"}),e(a.span,{className:"mord mtight",children:"2"})]})})]})})})})})]})]})]})]})}),"가 성립한다. 일반적으로는 실수오차 때문에 짜증나는 분수를 신나게 계산할 수 있다. 앳코더에서 자주 사용한다. 일반적으로 주어지는 소수 ",e(a.span,{className:"math math-inline",children:n(a.span,{className:"katex",children:[e(a.span,{className:"katex-mathml",children:e(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:n(a.semantics,{children:[e(a.mrow,{children:e(a.mi,{children:"p"})}),e(a.annotation,{encoding:"application/x-tex",children:"p"})]})})}),e(a.span,{className:"katex-html","aria-hidden":"true",children:n(a.span,{className:"base",children:[e(a.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),e(a.span,{className:"mord mathnormal",children:"p"})]})})]})}),"가 크기 때문에, 위의 빠른 거듭제곱 공식과 같이 사용해야 한다."]}),`
`,e(a.p,{children:"아래 백준 문제에 왜 이 방식을 쓰는지 자세히 설명되어 있다."}),`
`,n(a.ul,{children:[`
`,n(a.li,{children:["Sum 문제: ",e(a.a,{href:"https://www.acmicpc.net/problem/13172",children:"https://www.acmicpc.net/problem/13172"})]}),`
`]}),`
`,e(a.pre,{children:e(a.code,{className:"language-cpp",children:`ll getInv(ll v) {
    return fastPow(v, MOD - 2);
}
`})}),`
`,e(a.h2,{id:"time-complexity",children:"Time Complexity"}),`
`,n(a.ul,{children:[`
`,n(a.li,{children:[e(a.span,{className:"math math-inline",children:n(a.span,{className:"katex",children:[e(a.span,{className:"katex-mathml",children:e(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:n(a.semantics,{children:[n(a.mrow,{children:[e(a.mi,{children:"O"}),e(a.mo,{stretchy:"false",children:"("}),e(a.mi,{children:"log"}),e(a.mo,{children:"⁡"}),e(a.mi,{children:"N"}),e(a.mo,{stretchy:"false",children:")"})]}),e(a.annotation,{encoding:"application/x-tex",children:"O(\\log N)"})]})})}),e(a.span,{className:"katex-html","aria-hidden":"true",children:n(a.span,{className:"base",children:[e(a.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),e(a.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"O"}),e(a.span,{className:"mopen",children:"("}),n(a.span,{className:"mop",children:["lo",e(a.span,{style:{marginRight:"0.01389em"},children:"g"})]}),e(a.span,{className:"mspace",style:{marginRight:"0.1667em"}}),e(a.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"N"}),e(a.span,{className:"mclose",children:")"})]})})]})}),". 일종의 Binary Lifting 이다."]}),`
`]}),`
`,e(d,{}),`
`,e(h,{})]})}function p(s={}){const{wrapper:a}=Object.assign({},i(),s.components);return a?e(a,Object.assign({},s,{children:e(l,s)})):l(s)}const o=Object.freeze(Object.defineProperty({__proto__:null,default:p},Symbol.toStringTag,{value:"Module"})),m={};m.outlineInfo=t;m.main=o;export{m as default};
